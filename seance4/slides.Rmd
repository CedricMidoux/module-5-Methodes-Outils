---
title: "Croisement de données"
author: "Olivier Rué - Matthias Zytnicki"
subtitle: "DUBii - Module 5"
css: css/styles.css
libs: libs
date: "2020-06-05"
output:
    #html_document:
    #  self_contained: true
    #  number_sections: TRUE
    #  code_folding: "show"
    #  toc: true
    #  toc_depth: 2
    #  toc_float: true
    xaringan::moon_reader:
      nature:
        ratio: '16:9'
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(RefManageR)
BibOptions(check.entries = FALSE, bib.style = "authoryear", style = "markdown",
           dashed = TRUE)
file.name <- "biblio.bib"
bib <- ReadBib(file.name)
```

# Programme


- rappel sur les formats de fichiers (BED) et présentation VCF si on
part là-dessus

- Bedtools `r Citep(bib, "quinlan2010bedtools")` et ses fonctionnalités sous forme de questions

 * extraire les séquences des exons ?

 * trouver des gènes différentiellement exprimés ?

 * extaire des régions flanquantes ?

 * compter le nombre de variants dans des gènes ?

- SNPeff pour croiser variants et annotations structurales et fonctionnelles

 * impact des variants (amino acid changes) ?

---

# Rappels sur les formats de fichiers

Format  | Contenu
------------- | -------------
FASTA  | Information de séquence
FASTQ  | Séquence et qualité d'un read
SAM/BAM  | Alignement des reads sur une référence
BED/GTF/GFF  | Coordonnées et annotations génomiques
VCF  | Positions des variants génomiques entre des reads et une référence 

---

## FASTA

```bash
>foo
ATGCC
>bar other optional text could go here
CCGTA
>bidou
ACTGCAGT
TTCGN
>repeatmasker
ATGTGTcggggggATTTT
>prot2; my_favourite_prot
MTSRRSVKSGPREVPRDEYEDLYYTPSSGMASP
```

## FASTQ

```bash
@SEQ_ID
GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT
+
!''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65
```
---

## BED


---

### Questions

* 

* Est-ce que mes gènes différentiellement exprimés contiennent plus de promoteurs actifs qu’attendu ?

* Quels sont les variants qui sont dans les promoteurs de mes gènes différentiellement exprimés ?

* Quels sont les gènes différentiellement exprimés les plus proches de mes pics ChIP qui contiennent une mutation ?

---

## Données de ce cours

* Génome humain : <code>FASTA</code>
* Annotation : <code>GFF3</code>
* Variants : <code>VCF</code>
* Liste de gènes différentiellement exprimés : <code>TXT</code>
* Sites de fixation de H3K4me3 : <code>BED</code>

```{bash, eval=FALSE}
/shared/bank/homo_sapiens/GRCh38/fasta/Homo_sapiens.GRCh38.dna.toplevel.fa
```

---

## Cas n°1 : extraire les séquences de mes gènes



# References

```{r, results='asis', echo=FALSE}
PrintBibliography(bib, start=1, end=1)
```
