<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>NGS basics</title>
		<meta name="description" content="Variant Calling training">
		<meta name="author" content="Olivier Rué">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css" id="theme">
		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div class="reveal">
			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				
				<!-- TITLE OF TRAINING -->
				<section>
					<h2>Les basiques autour des NGS</h2>
					<h3>Module 5 - DUBii 2018</h3>
					<p>
						<small>Olivier Rué & Olivier Kirsh</small>
					</p>
					<img style="border:none ; box-shadow:none" src="https://f-origin.hypotheses.org/wp-content/blogs.dir/534/files/2017/04/UPD-logo-A-LA-UNE-1.png" width="20%"></img>
					<img style="border:none ; box-shadow:none" src="img/ifb_logo.png" width="20%"></img>
				</section>

				<!-- OBJECTIVES -->
				<section>
					<h1>Objectifs de ce cours</h1>
					<ul>
						<li>Connaître les ressources bioinformatiques en ligne pour traiter des données NGS</li>
						<li>Savoir récupérer en local ce type de ressources</li>
						<li>Découvrir les principaux formats de fichiers</li>
					</ul>

				</section>

				<!-- DATA -->
				<section>
					<h1>Jeu de données</h1>
					<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3688515/pdf/pgen.1003565.pdf">Bacterial regulons in Escherichia coli with ChIP-seq and RNA-seq</a></p>
					<p>Myers KS, Park DM, Beauchene NA, Kiley PJ. Defining bacterial regulons using ChIP-seq. Methods. 2015 Sep 15;86:80-8. doi: 10.1016/j.ymeth.2015.05.022. Epub 2015 May 29. Review.</p>
					<ul>
						<li>PubMed PMID: 26032817</li>
						<li>PubMed Central PMCID: PMC4577457</li>
					</ul>
				</section>
				
				<!-- CONNECTION ET EMPLACEMENT DES DONNEES -->
				
				<section>
					<h1>Environnement de travail</h1>
					<p>Pour ce cours, vous travaillerez sur la machine locale qui vous est mise à disposition</p>
					<p>Vous aurez besoin du terminal et d'un navigateur web</p>
					
						<img width="80" style="border:none ; box-shadow:none" height="80" data-src="https://aozoeky4dglp5sh0-zippykid.netdna-ssl.com/wp-content/uploads/2016/09/terminal-icon.png" alt="Down arrow">
						<img width="80" style="border:none ; box-shadow:none" height="80" data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/67/Firefox_Logo%2C_2017.svg/220px-Firefox_Logo%2C_2017.svg.png" alt="Down arrow">
				</section>
					
				
				
				<!-- Introduction -->
				<section>
					<section>
						<h1>Introduction</h1>
						<p>Les essentiels d'un <em>pipeline</em> d'analyse de données NGS</p>
					</section>
					<section>
						<ul>
							<li>Ressources (données issues du séquençage, génome de référence, annotations, base de données...)
								<ul>
									<li>centralisées</li>
									<li>pas toujours pour les organismes non modèles</li>
									<li>Une liste exhaustive est disponible entre autres <a href="https://anil.cchmc.org/BioInfoRes.html">ici</a></li>
								</ul>
							</li>
							<li>Outils
								<ul>
									<li>certains incontournables</li>
									<li>dépendants de la thématique et/ou de l'analyse souhaitée</li>
									<li>Beaucoup sont recensés ici : <a href="https://labworm.com/">labworm.com</a></li>
								</ul>
							</li>
							<li>Puissance de calcul (mémoire/coeurs)
								<ul>
									<li>clusters de calculs ouverts à la communauté</li>
									<li style='color:blue'>[cf cours Unix 2]</li>
								</ul>
							</li>
							
						</ul>
					</section>
				</section>

				<!-- Ressources bioinformatiques -->
				<section>
					<section>
						<h1>Les principales ressources en ligne</h1></br>
						<p>Vous aurez forcément besoin d'utiliser des ressources produites et expertisées par d'autres. Il existe une multitude de sites recensant des ressources bioinformatiques. Les incontournables et les plus généralistes sont :</p>
							<ul>
							
								<li>Nucleotide Sequence Databases :
									<ul>
										<li><a href="https://www.ncbi.nlm.nih.gov/">NCBI</a> (National Center for Biotechnology Information)</li>
										<li><a href="https://www.ebi.ac.uk/ena">ENA</a> (European Nucleotide Archive)</li>
									</ul>
								</li>
								<li>Genome databases :
									<ul>
										<li><a href="http://www.ensembl.org/">Ensembl</a> (vertebrate genomes)</li>
										<!--<li><a href="https://bacteria.ensembl.org/index.html">Ensembl bacteria</a> (bacterial genomes)</li>-->
									</ul>
								</li>
							</ul>
						
						<p>Une classification plus exhaustive (séquences protéiques, domaines protéiques, structures protéiques 3D, voies métaboliques...) est disponible entre autres <a href="https://anil.cchmc.org/BioInfoRes.html">ici</a></p>
						
					</section>
					<section>
						<h2>NCBI</h2></br>
						<p>Le NCBI héberge et met en relation de nombreuses bases de données :</p>
						<ul>
							<li><a href="https://www.ncbi.nlm.nih.gov/pubmed/">Pubmed</a> : publications et citations</li>
							<li><a href="https://www.ncbi.nlm.nih.gov/sra/">SRA</a> : Sequence Read Archive (données de sortie de séquençage ou alignées vs référence)</li>
							<li><a href="https://www.ncbi.nlm.nih.gov/genbank/">Genbank</a> : Collection de séquences ADN annotées publiques</li>
							<li><a href="https://www.ncbi.nlm.nih.gov/refseq/">RefSeq</a> : Collection de séquences de génomes, de transcripts et de protéines, non redondantes</li>
							<li><a href="https://www.ncbi.nlm.nih.gov/projects/SNP/">dbSNP</a> : Collection de variants, microsatellites... humains</li>
							<li><a href="https://www.ncbi.nlm.nih.gov/geo/">GEO</a> : Collection de données liées à l'expression des gènes</li>
							<li>...</li>
						</ul>
						<p>Tout (ou presque) est interconnecté</p>
					</section>
					<section>
						<h2>ENA</h2></br>
						<p>L'ENA est l'équivalent européen du NCBI, hébergé à l'EMBL-EBI :</p>
						<ul>
							<li>Données de séquençage</li>
							<li>Assemblages de génomes annotés</li>
							<li>Annotations fonctionnelles de génomes</li>
							<li>...</li>
						</ul>
						
					</section>
					<section>
						<h2>Les Accession Numbers</h2></br>
						<p>Les ressources sont décrites par un Accession Number. C'est leur numéro unique qui permet de les retrouver.</p>
						<p>La nomenclature change en fonction des ressources (NCBI, ENA...) mais le préfixe reste fixe :</p>
						<ul>
							<li>'DR' pour DDBJ Sequence Read Archive (DRA)</li>
							<li>'EGA' pour European Genome-phenome Archive (EGA)</li>
							<li>'ER' pour ENA Read</li>
							<li>'SR' pour NCBI Sequence Read Archive (SRA)</li>
						</ul>
						
					</section>
					
					
				</section>




				<!-- LES DONNEES DE SEQUENCAGE -->
				<section>
					<section>
						<h1>Les données issues du séquençage</h1>
					</section>
					
					<section>
						<h2>Les principales ressources publiques</h2>
						<p>La grande majorité des données brutes sont stockées soit au NCBI (Etats-Unis - NIH), soit à l'EBI (Angleterre - EMBL).</p>
						<p>Depuis quelques temps, les reviewers exigent que vos données soient déposées et accessibles à la communauté.</p>
						<p>SRA = 3 X ENA</p>
						
						<div style="float:left ; width:50%"><img src="https://www.ebi.ac.uk/ena/statistics/ena_sra_growth.png"></img></div>
						<div style="float:right ; width:50%"><img src="https://www.ncbi.nlm.nih.gov/Traces/sra/i/g.png"></img></div>
						
						
					</section>
					
					<section>
						<h2>Exercice n°1 : Retrouver où ont été déposées les données de séquençage de la publication</h2></br>
						<p><em>Une section est souvent dédiée à la mise à disposition des données en fin d'article</em></p>
						<ul>
							<li>Dans quelle base de données ont été déposées les données brutes ?</li>
							<li>Quel est leur numéro d'accession ?</li>
							<li>Allez sur le site en question et entrez le numéro d'accession dans la barre de recherche. Quelles informations avez-vous à disposition ?</li>
							<li>Cliquez sur le BioProject ID pour avoir accès aux données brutes, puis suivez le lien vers SRA</li>
							<li>Combien de fichiers de séquences brutes pouvez-vous récupérer ?</li>
							<li>Que pouvez-vous dire sur le séquençage du 1er run ?</li>
							<li>Pouvez-vous le télécharger via l'interface ?</li>
						</ul>
						
					</section>
					
					<section>
						<h2>Correction n°1</h2></br>
						<ul>
							<li>Dans quelle base de données ont été déposées les données brutes ? <em style='color:red'>GEO - NCBI</em></li>
							<li>Quel est leur numéro d'accession ? <em style='color:red'>GSE41195</em></li>
							<li>Allez sur le site en question et entrez le numéro d'accession dans la barre de recherche. Quelles informations avez-vous à disposition ? <em style='color:red'>auteurs, plateformes, publication, échantillons...</em></li>
							<li>Cliquez sur le BioProject ID pour avoir accès aux données brutes, puis suivez le lien vers SRA</li>
							<li>Combien de fichiers de séquences brutes pouvez-vous récupérer ? <em style='color:red'>13</em></li>
							<li>Que pouvez-vous dire sur le séquençage du 1er run ? <em style='color:red'>RNAseq, Illumina GAIIx, reads pairés, 36 pb...</em></li>
							<li>Pouvez-vous le télécharger via l'interface ? <em style='color:red'>Non</em></li>
						</ul>
						
					</section>
					
					<section>
						<h2>Exercice n°2 : Télécharger le run SRR5344684 avec la commande fastq-dump</h2></br>
						
						<p><em>Sélectionnez les options pour données pairées</em></p>
						
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						fastq-dump -h # Afficher l'aide
						fastq-dump -I --split-files SRR5344684
						</code></pre>
						
						<p><em>Affichez les dix premières lignes d'un fichier FASTQ. Comprenez-vous quelque chose ?</em></p>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						head SRR5344684_1.fastq
						</code></pre>
						
						En bonus le xargs pour automatiser
						
					</section>
					<section>
						<h1>Le format FASTQ</h1>
					</section>
					<section>
						<p>C'est le format utilisé pour stocker des fragments séquencés (lectures ou reads)</p>
						<p><img src="https://www.drive5.com/usearch/manual/fastq_fig.jpg"></img></p>
						<ul>
							<li>Fichier texte (.fastq)</li>
							<li>4 lignes par séquence</li>
							<li>Hautement compressible (.fastq.gz)</li>
						</ul>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
								gzip file.fastq # To compress
								gzip -d file.fastq.gz # To uncompress
						</code></pre>
						
					</section>
					<section>
						<h2>Encodage de la qualité de la base séquencée</h2>
						<p>Un score Phred est attribué par le séquenceur à chaque base séquencée, quelle que soit la technologie utilisée. Elle représente la confiance accordée à la base.</p>
						<p>Elle est encodée en ASCII pour tenir sur un seul caractère.</p>
						<p style="color:red">Les scores de qualité varient selon les technologies de séquençage ! Attention !</p>
						
						<img src="https://image.slidesharecdn.com/bioinfoformatvisualizationv3-150908135312-lva1-app6891/95/nextgeneration-sequencing-data-format-and-visualization-with-ngsplot-2015-12-638.jpg?cb=1441720516"></img>
						<img src="http://barcwiki.wi.mit.edu/raw-attachment/wiki/SOPs/qc_shortReads/fastq_phread-base.png"></img>
					</section>
					
					<section>
						<h2>Exercice n°3 : Extraire informations du FASTQ</h2></br>
						
						<p>Combien de séquences y a-t-il dans le fichier SRR5344684_1.fastq ?</p>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						wc -l SRR5344684_1.fastq # Puis diviser par 4
						# 89629572 SRR5344684_1.fastq
						cat SRR5344684_1.fastq | echo $((`wc -l`/4))
						# 22407393
						</code></pre>
						
						Voir si c'est abordé avant dans le cours Unix
						
					</section>
					
					<section>
						<h2>Contrôle qualité des fichiers FASTQ</h2></br>
						<p><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a> est la référence pour analyser la qualité des lectures au format FASTQ.</p>
						<p><a href="https://multiqc.info/">MultiQC</a> permet de synthétiser tous les rapports en un seul rapport.</p>
						<p>Vous aurez accès à :</p>
						<ul>
							<li>Nombre de lectures</li>
							<li>Taille des lectures</li>
							<li>Qualité moyenne de la base séquencée à chaque position</li>
							<li>Présence d'adaptateurs de séquençage</li>
							<li>GC content</li>
							<li>...</li>
						</ul>
						<p style="color:blue">Vous le verrez en détail lors du cours Production de données #2</p>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
								fastqc file.fastq.gz # Run fastqc on one compressed FASTQ file
						</code></pre>
					</section>
				</section>
				
				
				<!-- LE GENOME DE REFERENCE -->
				<section>
					<section>
						<h1>Le génome de référence</h1>
					</section>
					
					<section>
						<p>La plupart des pipelines bioinformatiques reposent sur la présence d'une référence. Soit elle existe, soit il faut en construire une.</p>
						<p>Attention, il existe des génomes complètement séquencés et très bien annotés (les organismes modèles), d'autres sont une succession de fragments représentant une sous-partie du génome.</p>
						<p>La croissance du nombre de génomes est exponentielle (exemple du génome humain) :</p>
						<div style="float:left ; width:50%"><img src="https://images.contentstack.io/v3/assets/blte41c17d7f8dda379/blta0a7b58fd26e80a1/5b16dae31d21468d5e20f689/costpergenome_2017.jpg"></img></div>
						<div style="float:right ; width:50%"><img src="https://spectrum.ieee.org/image/MzExMzUyMQ.jpeg"></img></div>
						
						
					</section>
					
					<section>
						<h2>Exercice n°2 : Récupérer le génome utilisé dans la publication : E. coli K-12 MG1655</h2></br>
						
						<ol>
							<li>Recherchez cette référence sur le site du NCBI</li>
							<li>Combien y a-t-il de versions de cet assemblage ?</li>
							<li>Téléchargez la dernière version mise à jour</li>
							<li>Affichez les dix premières lignes du fichier</li>
						</ol>
					</section>
					
					<section>
						<img src="img/NCBI_1.png"></img>
					</section>
					<section>
						<img src="img/NCBI_2.png"></img>
					</section>
					<section>
						<img src="img/NCBI_3.png"></img>
					</section>
					<section>
						<img src="img/NCBI_4.png"></img>
					</section>
					<section>
						<img src="img/NCBI_5.png"></img>
					</section>
					<section>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						head sequence.fasta
						>NZ_CP032667.1 Escherichia coli str. K-12 substr. MG1655 chromosome, complete genome
						GTCCCGGCCCCGGCAGAACCGACCTATCGTTCTAACGTAAACGTCAAACACACGTTTGATAACTTCGTTG
						AAGGTAAATCTAACCAACTGGCGCGCGCGGCGGCTCGCCAGGTGGCGGATAACCCTGGCGGTGCCTATAA
						CCCGTTGTTCCTTTATGGCGGCACGGGTCTGGGTAAAACTCACCTGCTGCATGCGGTGGGTAACGGCATT
						ATGGCGCGCAAGCCGAATGCCAAAGTGGTTTATATGCACTCCGAGCGCTTTGTTCAGGACATGGTTAAAG
						CCCTGCAAAACAACGCGATCGAAGAGTTTAAACGCTACTACCGTTCCGTAGATGCACTGCTGATCGACGA
						TATTCAGTTTTTTGCTAATAAAGAACGATCTCAGGAAGAGTTTTTCCACACCTTCAACGCCCTGCTGGAA
						GGTAATCAACAGATCATTCTCACCTCGGATCGCTATCCGAAAGAGATCAACGGCGTTGAGGATCGTTTGA
						AATCCCGCTTCGGTTGGGGACTGACTGTGGCGATCGAACCGCCAGAGCTGGAAACCCGTGTGGCGATCCT
						GATGAAAAAGGCCGACGAAAACGACATTCGTTTGCCGGGCGAAGTGGCGTTCTTTATCGCCAAGCGTCTA

						</code></pre>
					</section>
						
					
					<section>
						<h1>Le format FASTA</h1>
					</section>
					
					<section>
						<p>C'est un fichier texte contenant des informations sur une séquence (nucléique ou protéique).</p>
						<p><img src="https://slideplayer.com/slide/4463200/14/images/38/FASTA+Format+simple+format+used+by+almost+all+programs.jpg"></img></p>
						<p>Des blocs de 60 lettres sont souvent utilisés.</p>
						<p>L'extension peut être .fa, .fasta, .fna...</p>
					</section>
				</section>

				<!-- LE MAPPING -->
				<section>
					<section>
						<h1>Le mapping</h1>
					</section>
					
					<section>
						<h2>Les algorithmes de mapping</h2>
						<p>Les algorithmes de mapping doivent s'adapter à la quantité et à la longueur des lectures issues du séquençage.</p>
						<div style="float:left ; width:50%"><img src="img/mapping_tools.png"></img></div>
						<div style="float:right ; width:50%"><img width="70%" src="https://www.ebi.ac.uk/~nf/hts_mappers/mappers_timeline.jpeg"></div>
						
					</section>
					
					<section>
						<p>Le choix de l'outil et le paramétrage est dépendant des données (nature, longueur, quantité)</p>
						<p>Quelques exemples parmi les plus utilisés :</p>
						<ul>
							<li>
								Génomique :
								<ul>
									<li><a href="http://bowtie-bio.sourceforge.net/bowtie2/index.shtml">bowtie2</a> / <a href="http://bio-bwa.sourceforge.net/">bwa</a> : lectures courtes <1 kb</li>
								</ul>
							</li>
							<li>
								Transcriptomique (alignement splicé):
								<ul>
									<li><a href="https://github.com/alexdobin/STAR">STAR</a></li>
									<li><a href="http://tophat.cbcb.umd.edu/">TopHat</a></li>
									<li><a href="https://ccb.jhu.edu/software/hisat2/index.shtml">HiSat2</a></li>
								</ul>
							</li>
							<li>
								Long reads:
								<ul>
									<li><a href="https://github.com/alexdobin/STAR">STAR</a></li>
									<li>Encore une question de recherche !</li>
								</ul>
							</li>
							
						</ul>
					</section>
					
					<section>
						<h2>Avant de mapper les reads... on nettoie</h2>
						<p>Il faut nettoyer les reads pour enlever tout ce qui n'est pas 'biologique' et de 'mauvaise qualité' :</p>
						<ul>
							<li>Enlever les adaptateurs de séquençage, les barcodes... (<a href="https://cutadapt.readthedocs.io/en/stable/guide.html">cutadapt</a>...)</li>
							<li>Trimmer les bases de mauvaise qualité (<a href="https://github.com/najoshi/sickle">sickle</a>, <a href="http://www.usadellab.org/cms/index.php?page=trimmomatic">trimmomatic</a>...)</li>
						</ul>
						<p><img src="https://www.gendx.com/images/stories/illumina/NGS%20workflow%20indexing%20illumina.png"></img></p>
						
						
					</section>
					
					<section>
						<h2>Avant de mapper les reads... on nettoie</h2>
						<p>Puis filtrer/nettoyer/pre-processer selon différents critères :</p>
						<ul>
							<li>Enlever les lectures contenant des bases ambigues (pas toujours supportées par les outils)</li>
							<li>Supprimer les lectures trop petites</li>
							<li>Supprimer les lectures avec une complexité trop faible</li>
							<li>Merger les paires chevauchantes (<a href="https://cme.h-its.org/exelixis/web/software/pear/">pear</a>, <a href="https://github.com/torognes/vsearch">vsearch</a>...)</li>
							<li>...</li>
						</ul>
						<p>
							<img src="img/trimming.png"></img>
						</p>
						
					</section>
					
					<section>
						<h2>Avant de mapper les reads... on nettoie</h2>
						<p>Chaque jeu de données est différent ! Il faut mesurer les effets de chaque étape (nombre de reads perdus, taille...) en faisant des graphiques, des tableaux...</p>
						<p>C'est l'expérience qui guidera ensuite vos choix.</p>
					</section>
					
					<section>
						<h2>Le format SAM / BAM</h2>
					</section>
					
					<section>
						<p>Le format <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM</a> a été élaboré lors du projet des 1000 génomes humains.</p>
						<p>Il permet de stocker toutes les informations utiles des lectures alignées sur une référence.</p>
						<p>Tous les outils de mapping génèrent du SAM.</p>
						<p>Hautement compressible, indexable pour un accès rapide à l'information.</p>
						<p>Le format SAM est un fichier texte. Sa version compressée est un BAM. Sa version ultra compressée est un <a href="https://samtools.github.io/hts-specs/CRAMv3.pdf">CRAM</a>.</p>
					</section>
					<section>
						<h2>Les informations dans le SAM</h2>
						<img src="https://www.samformat.info/images/sam_format_annotated_example.5108a0cd.jpg"></img>
						<p>Documentation : <a href="https://broadinstitute.github.io/picard/explain-flags.html">SAM flags</a></p>
					</section>
					<section>
						<h2>Les informations dans le SAM</h2>
						<img src="img/SAM.png"></img>
						
					</section>
					<section>
						<h2>Manipuler les formats SAM / BAM</h2>
						<p>En complément du format, la suite d'outils <a href="">SAMTOOLS</a> a été développée pour manipuler ces formats.</p>
						<p>Fonctionnalités :</p>
						<ul>
							<li>Compression / Décompression</li>
							<li>Tri / Indexage</li>
							<li>Merge</li>
							<li>Statistiques</li>
							<li>...</li>
						</ul>
					</section>
					<section>
						<h2>Exercice n°X : Manipuler des fichiers SAM/BAM</h2>
						<p>Visualiser le contenu d'un fichier BAM</p>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						samtools view # Affiche l'aide
						samtools view file.bam | less # Ne pas oublier | less
						</code></pre>
						<p>Obtenir des statistiques sur le fichier BAM</p>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						samtools flafstat # Affiche l'aide
						samtools flagstat file.bam
						</code></pre>
						<p>Trier le fichier BAM</p>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						samtools sort # Affiche l'aide
						samtools sort -o file.sorted.bam file.bam
						</code></pre>
						<p>Indexer le fichier BAM</p>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						samtools index # Affiche l'aide
						samtools index file.sorted.bam
						</code></pre>
					</section>
				</section>

				<!-- LES ANNOTATIONS DU GENOME DE REFERENCE -->
				<section>
					<section>
						<h1>Les annotations  du génome de référence</h1>
					</section>
					
					<section>
						<p>Le génome de référence donne uniquement des informations sur la séquence. Toutes les informations recensées <a href="http://www.sequenceontology.org/so_wiki/index.php/Category:SO:SOFA">ici (Sequence Ontology)</a> (intron, exon, promoter, rRNA, CDS, centromere...) sont stockées ailleurs, dans un fichier d'annotation, qui indique leurs positions et leurs caractéristiques. </p>
					</section>
					
					<section>
						<h1>Le format GFF</h1>
					</section>
					<section>
						<p>Le format <a href="(http://gmod.org/wiki/GFF3)">Gene Feature Format</a>(GFF/ GFF2/GFF3) est un fichier texte où chaque ligne correspond à une annotation ou une feature.</p>
						<p>Exemple d'un GFF3 :</p>
						<p><img src="http://resources.qiagenbioinformatics.com/manuals/biomedicalgenomicsworkbench/350/importgff3.png"></img></p>
					</section>
					<section>
						<p>Attention aux confusions. Les formats GFF, GFF2 et GFF3 sont légèrement différents. Certains outils nécessitent un format partuiculier pour les annotations. Cependant, les formats GFF et GFF2 sont dépréciés.</p>
						<p>Le format GTF est identique au format GFF2</p>
						<p>La séquence peut être ajoutée en fin de GFF3.</p>
						<p>Il existe d'autres formats d'annotation, notamment <a href="http://quma.cdb.riken.jp/help/gbHelp.html">Genbank</a>, spécifique au NCBI, qui contient séquences et annotations.</p>
						<em>Exemple d'une partie d'un fichier Genbank :</em>
						<p><img src="http://aclame.ulb.ac.be/Tools/Prophinder/genbank_format.png"></img></p>
					</section>
					<section>
						<h2>Exercice n°X : Récupérer l'annotation du génome E. coli K-12 MG1655</h2></br>
					</section>
					<section>
						<img src="img/NCBI_gff.png"></img>
					</section>
					<section>
						<p>Affichier les 10 premières lignes du fichier GFF3</p>>
						<pre style='width:80%'><code class="bash" data-trim contenteditable>
						head sequence.gff3
						##sequence-region NZ_CP032667.1 1 4639694
						##species https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=511145
						NZ_CP032667.1	RefSeq	region	1	4639694	.	+	.	ID=NZ_CP032667.1:1..4639694;Dbxref=taxon:511145;Is_circular=true;Name=ANONYMOUS;collection-date=2018;country=USA: Philadelphia;gbkey=Src;genome=chromosome;lat-lon=39.95 N 75.16 W;mol_type=genomic DNA;note=obtained from culture collection;old-name=Escherichia coli K-12;strain=K-12;substrain=MG1655
						NZ_CP032667.1	RefSeq	gene	1052	2152	.	+	.	ID=gene-D8B36_RS00010;Name=D8B36_RS00010;gbkey=Gene;gene_biotype=protein_coding;locus_tag=D8B36_RS00010;old_locus_tag=D8B36_00010
						NZ_CP032667.1	Protein Homology	CDS	1052	2152	.	+	0	ID=cds-WP_000673464.1;Parent=gene-D8B36_RS00010;Dbxref=Genbank:WP_000673464.1;Name=WP_000673464.1;gbkey=CDS;inference=COORDINATES: similar to AA sequence:RefSeq:WP_006177590.1;locus_tag=D8B36_RS00010;product=DNA polymerase III subunit beta;protein_id=WP_000673464.1;transl_table=11
						NZ_CP032667.1	RefSeq	gene	2152	3225	.	+	.	ID=gene-D8B36_RS00015;Name=recF;gbkey=Gene;gene=recF;gene_biotype=protein_coding;locus_tag=D8B36_RS00015;old_locus_tag=D8B36_00015
						NZ_CP032667.1	Protein Homology	CDS	2152	3225	.	+	0	ID=cds-WP_000060112.1;Parent=gene-D8B36_RS00015;Dbxref=Genbank:WP_000060112.1;Name=WP_000060112.1;gbkey=CDS;gene=recF;inference=COORDINATES: similar to AA sequence:RefSeq:WP_005121479.1;locus_tag=D8B36_RS00015;product=DNA replication/repair protein RecF;protein_id=WP_000060112.1;transl_table=11
						NZ_CP032667.1	RefSeq	gene	3254	5668	.	+	.	ID=gene-D8B36_RS00020;Name=D8B36_RS00020;gbkey=Gene;gene_biotype=protein_coding;locus_tag=D8B36_RS00020;old_locus_tag=D8B36_00020
						NZ_CP032667.1	Protein Homology	CDS	3254	5668	.	+	0	ID=cds-WP_000072067.1;Parent=gene-D8B36_RS00020;Dbxref=Genbank:WP_000072067.1;Name=WP_000072067.1;gbkey=CDS;inference=COORDINATES: similar to AA sequence:RefSeq:NP_312661.1;locus_tag=D8B36_RS00020;product=DNA gyrase subunit B;protein_id=WP_000072067.1;transl_table=11
						NZ_CP032667.1	RefSeq	gene	5899	6306	.	+	.	ID=gene-D8B36_RS00025;Name=D8B36_RS00025;gbkey=Gene;gene_biotype=protein_coding;locus_tag=D8B36_RS00025;old_locus_tag=D8B36_00025

						</code></pre>
					</section>
				</section>
				
				
					
					<!--
					<section>
						<h1>Autres indispensables</h1>
					</section>
					-->
				</section>
				


			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				width: '80%',
				height: '100%',
				transition: 'slide', // none/fade/slide/convex/concave/zoom
				tableofcontents: {
					// Specifies the slide title of the table of contents slide
					title: "Programme",
					// Specifies the position of the table of contents slide in the presentation
					position: 2,
					// Specifies which slide tag elements will be used
					// for generating the table of contents.
					titleTagSelector: "h1",

					// Specifies if the first slide, mostly the title slide of the presentation, should be ignored.
					ignoreFirstSlide: true,

					// Specifies if every single element of the table of contents
					// will be stepped through before moving on to the next slide.
					fadeInElements: false
				},

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/search/search.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/tableofcontents.js' }
				]
			});
			Reveal.configure({ slideNumber: true });

		</script>

	</body>
</html>
